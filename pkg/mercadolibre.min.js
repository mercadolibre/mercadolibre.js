(function(){var cookie=function(name,value,options){if(typeof value!="undefined"){options=options||{};if(value===null){value="";options.expires=-1}var expires="";if(options.expires&&(typeof options.expires=="number"||options.expires.toUTCString)){var date;if(typeof options.expires=="number"){date=new Date();date.setTime(date.getTime()+(options.expires*24*60*60*1000))}else{date=options.expires}expires="; expires="+date.toUTCString()}var path=options.path?"; path="+(options.path):"";var domain=options.domain?"; domain="+(options.domain):"";var secure=options.secure?"; secure":"";document.cookie=[name,"=",encodeURIComponent(value),expires,path,domain,secure].join("")}else{var cookieValue=null;if(document.cookie&&document.cookie!=""){var cookies=document.cookie.split(/; ?/);for(var i=0;i<cookies.length;i++){var cookie=cookies[i];if(cookie.substring(0,name.length+1)==(name+"=")){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break}}}return cookieValue}};var DESCipher={des:function(key,message,encrypt,mode,iv,padding){var spfunction1=new Array(16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756);var spfunction2=new Array(-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344);var spfunction3=new Array(520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584);var spfunction4=new Array(8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928);var spfunction5=new Array(256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080);var spfunction6=new Array(536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312);var spfunction7=new Array(2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154);var spfunction8=new Array(268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696);var keys=this.des_createKeys(key);var m=0,i,j,temp,temp2,right1,right2,left,right,looping;var cbcleft,cbcleft2,cbcright,cbcright2;var endloop,loopinc;var len=message.length;var chunk=0;var iterations=keys.length==32?3:9;if(iterations==3){looping=encrypt?new Array(0,32,2):new Array(30,-2,-2)}else{looping=encrypt?new Array(0,32,2,62,30,-2,64,96,2):new Array(94,62,-2,32,64,2,30,-2,-2)}if(padding==2){message+="        "}else{if(padding==1){temp=8-(len%8);message+=String.fromCharCode(temp,temp,temp,temp,temp,temp,temp,temp);if(temp==8){len+=8}}else{if(!padding){message+="\0\0\0\0\0\0\0\0"}}}result="";tempresult="";if(mode==1){cbcleft=(iv.charCodeAt(m++)<<24)|(iv.charCodeAt(m++)<<16)|(iv.charCodeAt(m++)<<8)|iv.charCodeAt(m++);cbcright=(iv.charCodeAt(m++)<<24)|(iv.charCodeAt(m++)<<16)|(iv.charCodeAt(m++)<<8)|iv.charCodeAt(m++);m=0}while(m<len){left=(message.charCodeAt(m++)<<24)|(message.charCodeAt(m++)<<16)|(message.charCodeAt(m++)<<8)|message.charCodeAt(m++);right=(message.charCodeAt(m++)<<24)|(message.charCodeAt(m++)<<16)|(message.charCodeAt(m++)<<8)|message.charCodeAt(m++);if(mode==1){if(encrypt){left^=cbcleft;right^=cbcright}else{cbcleft2=cbcleft;cbcright2=cbcright;cbcleft=left;cbcright=right}}temp=((left>>>4)^right)&252645135;right^=temp;left^=(temp<<4);temp=((left>>>16)^right)&65535;right^=temp;left^=(temp<<16);temp=((right>>>2)^left)&858993459;left^=temp;right^=(temp<<2);temp=((right>>>8)^left)&16711935;left^=temp;right^=(temp<<8);temp=((left>>>1)^right)&1431655765;right^=temp;left^=(temp<<1);left=((left<<1)|(left>>>31));right=((right<<1)|(right>>>31));for(j=0;j<iterations;j+=3){endloop=looping[j+1];loopinc=looping[j+2];for(i=looping[j];i!=endloop;i+=loopinc){right1=right^keys[i];right2=((right>>>4)|(right<<28))^keys[i+1];temp=left;left=right;right=temp^(spfunction2[(right1>>>24)&63]|spfunction4[(right1>>>16)&63]|spfunction6[(right1>>>8)&63]|spfunction8[right1&63]|spfunction1[(right2>>>24)&63]|spfunction3[(right2>>>16)&63]|spfunction5[(right2>>>8)&63]|spfunction7[right2&63])}temp=left;left=right;right=temp}left=((left>>>1)|(left<<31));right=((right>>>1)|(right<<31));temp=((left>>>1)^right)&1431655765;right^=temp;left^=(temp<<1);temp=((right>>>8)^left)&16711935;left^=temp;right^=(temp<<8);temp=((right>>>2)^left)&858993459;left^=temp;right^=(temp<<2);temp=((left>>>16)^right)&65535;right^=temp;left^=(temp<<16);temp=((left>>>4)^right)&252645135;right^=temp;left^=(temp<<4);if(mode==1){if(encrypt){cbcleft=left;cbcright=right}else{left^=cbcleft2;right^=cbcright2}}tempresult+=String.fromCharCode((left>>>24),((left>>>16)&255),((left>>>8)&255),(left&255),(right>>>24),((right>>>16)&255),((right>>>8)&255),(right&255));chunk+=8;if(chunk==512){result+=tempresult;tempresult="";chunk=0}}return result+tempresult},des_createKeys:function(key){pc2bytes0=new Array(0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964);pc2bytes1=new Array(0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697);pc2bytes2=new Array(0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272);pc2bytes3=new Array(0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144);pc2bytes4=new Array(0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256);pc2bytes5=new Array(0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488);pc2bytes6=new Array(0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746);pc2bytes7=new Array(0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568);pc2bytes8=new Array(0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578);pc2bytes9=new Array(0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488);pc2bytes10=new Array(0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800);pc2bytes11=new Array(0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744);pc2bytes12=new Array(0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128);pc2bytes13=new Array(0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261);var iterations=key.length>8?3:1;var keys=new Array(32*iterations);var shifts=new Array(0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0);var lefttemp,righttemp,m=0,n=0,temp;for(var j=0;j<iterations;j++){var left=(key.charCodeAt(m++)<<24)|(key.charCodeAt(m++)<<16)|(key.charCodeAt(m++)<<8)|key.charCodeAt(m++);var right=(key.charCodeAt(m++)<<24)|(key.charCodeAt(m++)<<16)|(key.charCodeAt(m++)<<8)|key.charCodeAt(m++);temp=((left>>>4)^right)&252645135;right^=temp;left^=(temp<<4);temp=((right>>>-16)^left)&65535;left^=temp;right^=(temp<<-16);temp=((left>>>2)^right)&858993459;right^=temp;left^=(temp<<2);temp=((right>>>-16)^left)&65535;left^=temp;right^=(temp<<-16);temp=((left>>>1)^right)&1431655765;right^=temp;left^=(temp<<1);temp=((right>>>8)^left)&16711935;left^=temp;right^=(temp<<8);temp=((left>>>1)^right)&1431655765;right^=temp;left^=(temp<<1);temp=(left<<8)|((right>>>20)&240);left=(right<<24)|((right<<8)&16711680)|((right>>>8)&65280)|((right>>>24)&240);right=temp;for(var i=0;i<shifts.length;i++){if(shifts[i]){left=(left<<2)|(left>>>26);right=(right<<2)|(right>>>26)}else{left=(left<<1)|(left>>>27);right=(right<<1)|(right>>>27)}left&=-15;right&=-15;lefttemp=pc2bytes0[left>>>28]|pc2bytes1[(left>>>24)&15]|pc2bytes2[(left>>>20)&15]|pc2bytes3[(left>>>16)&15]|pc2bytes4[(left>>>12)&15]|pc2bytes5[(left>>>8)&15]|pc2bytes6[(left>>>4)&15];righttemp=pc2bytes7[right>>>28]|pc2bytes8[(right>>>24)&15]|pc2bytes9[(right>>>20)&15]|pc2bytes10[(right>>>16)&15]|pc2bytes11[(right>>>12)&15]|pc2bytes12[(right>>>8)&15]|pc2bytes13[(right>>>4)&15];temp=((righttemp>>>16)^lefttemp)&65535;keys[n++]=lefttemp^temp;keys[n++]=righttemp^(temp<<16)}}return keys}};var DESExtras={BASE64:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],stringToBase64:function(s){var r="",c1,c2,c3;for(var i=0;i<s.length;i+=3){c1=s.charCodeAt(i);c2=i+1>=s.length?0:s.charCodeAt(i+1);c3=i+2>=s.length?0:s.charCodeAt(i+2);r+=this.BASE64[c1>>2];r+=this.BASE64[((c1&3)<<4)|(c2>>4)];r+=c2?this.BASE64[((c2&15)<<2)|(c3>>6)]:"=";r+=c3?this.BASE64[c3&63]:"="}return r},base64ToString:function(s){var decode=new Object();for(var i=0;i<this.BASE64.length;i++){decode[this.BASE64[i]]=i}decode["="]=0;var r="",c1,c2,c3,c4,len=s.length;s+="====";for(var i=0;i<len;i+=4){c1=s.charAt(i);c2=s.charAt(i+1);c3=s.charAt(i+2);c4=s.charAt(i+3);r+=String.fromCharCode(((decode[c1]<<2)&255)|(decode[c2]>>4));if(c3!="="){r+=String.fromCharCode(((decode[c2]<<4)&255)|(decode[c3]>>2))}if(c4!="="){r+=String.fromCharCode(((decode[c3]<<6)&255)|decode[c4])}}return r},stringToHex:function(s){var r="0x";var hexes=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");for(var i=0;i<s.length;i++){r+=hexes[s.charCodeAt(i)>>4]+hexes[s.charCodeAt(i)&15]}return r},hexToString:function(h){var r="";for(var i=(h.substr(0,2)=="0x")?2:0;i<h.length;i+=2){r+=String.fromCharCode(parseInt(h.substr(i,2),16))}return r}};(function(){if(!this.JSON){this.JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());var Sroc=(function(){return{counter:1,get:function(url,params,callback){this.request("GET",url,params,callback)},post:function(url,params,callback){this.request("POST",url,params,callback)},remove:function(url,params,callback){this.request("DELETE",url,params,callback)},request:function(method,url,params,callback){var name=this._callbackName();window[name]=function(status,headers,body){callback.call(null,status,headers,body);window[name]=null;try{delete window[name]}catch(e){}};this.load(this.url(method,url,params,name))},load:function(url){var done=false;var script=document.createElement("script");script.src=url+(url.indexOf("?")>-1?"&":"?")+"_MELI_SDK_RANDOM="+Math.random()*Math.random();script.async=true;script.onload=script.onreadystatechange=function(){if(!done&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){done=true;script.onload=script.onreadystatechange=null;if(script&&script.parentNode){script.parentNode.removeChild(script)}}};document.getElementsByTagName("head")[0].appendChild(script)},url:function(method,url,params,callbackName){var key;url+=url.indexOf("?")>-1?"&":"?";url+="callback="+callbackName;if(method=="GET"){for(key in params){if(params.hasOwnProperty(key)){url+="&"+key+"="+encodeURIComponent(params[key])}}}else{url+="&_method="+method+"&_body="+encodeURIComponent(JSON.stringify(params))}return url},_callbackName:function(){return"jsonp"+(this.counter++)}}})();window.Sroc=Sroc})();var XAuth=(function(){var j=window;var q=!(j.postMessage&&j.localStorage&&j.JSON);var data={n:"static.mlstatic.com",xdp:"/xd.html",port:""};data.e="http://"+data.n+(data.port?":"+data.port:"")+data.xdp;var g=null;var a=null;var p={};var d=0;var m=[];var listeners=null;function init(){if(data){data.e="http://"+data.n+(data.port?":"+data.port:"")+data.xdp}if(listeners){return}else{if(j.addEventListener){j.addEventListener("message",o,false)}else{if(j.attachEvent){j.attachEvent("onmessage",o)}}listeners=true}}function o(s){try{var u=s.origin.split("://")[1].split(":")[0];var n=data.n;if(u!=n){return}var t=JSON.parse(s.data);if(!t){return}if(t.cmd=="xauth::ready"){a=g.contentWindow;setTimeout(f,0);return}else{if(t.cmd=="meli::loginComplete"){MercadoLibre._loginComplete(t.data);return}else{if(t.cmd=="meli::authComplete"){MercadoLibre._authComplete(t.data);return}else{if(t.cmd=="meli::logout"){MercadoLibre._logoutComplete()}else{if(t.cmd=="meli::close"){close()}}}}}var r=p[t.id];if(r){if(r.callback){r.callback(t)}delete p[t.id]}}catch(error){}}function i(){if(g||a){g.src=data.e;return}var s=j.document;g=s.createElement("iframe");g.id="xauthIFrame";var r=g.style;r.position="absolute";r.left=r.top="-999px";s.body.appendChild(g);init();g.src=data.e}function f(){for(var r=0;r<m.length;r++){c(p[m.shift()])}}function c(r){a.postMessage(JSON.stringify(r),data.e)}function h(r){if(q){return}r.id=d;p[d++]=r;if(!g||!a){m.push(r.id);i()}else{c(r)}}function l(r){if(!r){r={}}var s={cmd:"xauth::retrieve",retrieve:r.retrieve||[],callback:r.callback||null};h(s)}function k(r){if(!r){r={}}var s={cmd:"xauth::extend",data:r.data||"",key:r.key||"",expire:r.expire||0,extend:r.extend||[],session:r.session||false,callback:r.callback||null};h(s)}function b(r){if(!r){r={}}var s={cmd:"xauth::expire",key:r.key||null,callback:r.callback||null};h(s)}return{init:init,data:data,extend:k,retrieve:l,expire:b,disabled:q}})();(function(cookie,XAuth){var Store=function(){this.map={};return this};Store.localStorageAvailable=(function(){try{return("localStorage" in window)&&window.localStorage!==null}catch(e){return false}})();if(Store.localStorageAvailable){Store.prototype.get=function(key){return window.localStorage.getItem(key)};Store.prototype.set=function(key,value){window.localStorage.setItem(key,value)};Store.prototype.getSecure=function(key,secret){var crypto=this.get(key);if(secret&&secret!=""&&crypto){var value=this._decrypt(secret,crypto);var length=parseInt(this.get(key+".length"));return value.substring(0,length)}return undefined};Store.prototype.setSecure=function(key,value,options){options=options||{};var domain=options.domain?options.domain:window.location.hostname;var secret=this._generateSecret();var data=JSON.stringify(value.data);var crypto=this._encrypt(secret,data);value.data=crypto;this.set(key,JSON.stringify(value));return{s:secret,l:data.length}};Store.prototype._encrypt=function(secret,message){var crypto=DESCipher.des(secret,message,1,0,null);crypto=DESExtras.stringToHex(crypto);return crypto};Store.prototype._decrypt=function(secret,crypto){var message=DESExtras.hexToString(crypto);message=DESCipher.des(secret,message,0,0,null);return message};Store.prototype._generateSecret=function(){var v=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","1","2","3","4","5","6","7","8","9","0"];for(var j,x,i=v.length;i;j=parseInt(Math.random()*i),x=v[--i],v[i]=v[j],v[j]=x){}var secret=v.slice(0,8).join("");return secret}}else{Store.prototype.get=function(key){return this.map[key]};Store.prototype.set=function(key,value){this.map[key]=value}}var Sroc=window.Sroc;var MELI={baseURL:"https://api.mercadolibre.com",authorizationURL:"http://auth.mercadolibre.com/authorization",authorizationStateURL:"https://www.mercadolibre.com/jms/SITE/oauth/authorization/state",logoutURL:"http://DOMAIN/jm/logout?urlTo=",AUTHORIZATION_STATE:"authorization_state",mlSites:{MLA:"com.ar",MLB:"com.br",MLU:"com.uy",MLC:"cl",MEC:"com.ec",MPE:"com.pe",MPT:"pt",MLV:"com.ve",MCO:"com.co",MCR:"co.cr",MPA:"com.pa",MRD:"com.do",MLM:"com.mx"},options:{},hash:{},callbacks:{},pendingCallbacks:[],store:new Store(),appInfo:null,isAuthorizationStateAvaible:false,authorizationState:{},authorizationStateAvailableCallbacks:[],authorizationStateCallbackInProgress:false,authorizationStateCallbackTimer:null,synchronizationInProgress:false,unknownStatus:{state:"UNKNOWN",authorization_info:{access_token:"",expires_in:0,user_id:null}},refreshing:false,showLogin:true,messages:(window.postMessage&&window.localStorage&&window.JSON),initialized:false,initCallbacks:[],_partial:function(func){var args=Array.prototype.slice.call(arguments,1);var self=this;return function(){var allArguments=args.concat(Array.prototype.slice.call(arguments));return func.apply(self,allArguments)}},init:function(options){this.options=options;this.messages=(window.postMessage&&window.localStorage&&window.JSON);if(this.options.test){this.baseURL=this.options.test;this.isAuthorizationStateAvaible=true;var status={state:"AUTHORIZED",authorization_info:{access_token:"faketoken",expires_in:new Date(new Date().getTime()+parseInt(10800)*1000).getTime(),user_id:null}};this.authorizationState[this._getKey()]=status}if(this.options.site_id=="MLB"||this.options.site_id=="MPT"){this.authorizationURL=this.authorizationURL.replace("mercadolibre","mercadolivre");this.authorizationStateURL=this.authorizationStateURL.replace("mercadolibre","mercadolivre")}this.logoutURL=this.logoutURL.replace("DOMAIN",this._getDomain());if(!this.options.xauth_domain){this.options.xauth_domain="static.mlstatic.com"}if(!this.options.auth_timeout){this.options.auth_timeout=10000}if(this.options.xauth_domain_fallback&&!this.messages){this.options.xauth_domain=this.options.xauth_domain_fallback}if(!this.options.xd_url){this.options.xd_url="/org-img/sdk/xd_sdk.html"}if(typeof(this.options.show_login)!="undefined"){this.showLogin=this.options.show_login}XAuth.data.n=this.options.xauth_domain;XAuth.data.xdp=this.options.xd_url;XAuth.data.port=this.options.xauth_port;if(window.self==window.top){XAuth.init()}this.initialized=true;while(this.initCallbacks.length>0){var callback=this.initCallbacks.shift();try{callback()}catch(e){}}},_getDomain:function(){if(this.mlSites[this.options.site_id]==null){return null}var domain="www.mercadoli";if(this.options.site_id=="MLB"||this.options.site_id=="MPT"){domain+="vre."}else{domain+="bre."}domain+=this.mlSites[this.options.site_id];return domain},waitForInit:function(callback){if(this.initialized){callback()}else{this.initCallbacks.push(callback)}},_isExpired:function(authState){if(authState==null){return true}if(typeof(authState.authorization_info)=="undefined"){return true}var expirationTime=authState.authorization_info.expires_in;if(expirationTime){var dateToExpire=new Date(parseInt(expirationTime));var now=new Date();if(dateToExpire<=now){return true}}return false},_decryptAuthorizationState:function(state){var retVal=this.store._decrypt(this.secret.s,state);var length=parseInt(this.secret.l);retVal=retVal.substring(0,length);retVal=JSON.parse(retVal);return retVal},_synchronizeAuthorizationState:function(tryRemote){if(!this.initialized){this.initCallbacks.push(this._partial(this._synchronizeAuthorizationState,tryRemote));return}var key=this._getKey();var obj=this;if(this.messages){XAuth.retrieve({retrieve:[key],callback:function(value){obj._updateSecret();var notify=true;if(tryRemote&&(value.tokens[key]==null||((obj.secret==null||obj.secret=="")&&(cookie("ats")==null||cookie("ats")=="")))){obj._getRemoteAuthorizationState()}else{var authState=obj.unknownStatus;if(typeof(value.tokens[key])!="undefined"){var authState=null;try{authState=value.tokens[key].data;authState=obj._decryptAuthorizationState(authState);authState.expiration=authState.expire}catch(e){authState=null}if(obj._isExpired(authState)&&tryRemote){obj._getRemoteAuthorizationState();notify=false}}if(notify){obj.authorizationState[key]=authState;obj._onAuthorizationStateAvailable(authState)}}}})}else{obj._getRemoteAuthorizationState()}},_getRemoteAuthorizationState:function(){if(!this.initialized){this.initCallbacks.push(this._getRemoteAutorizationState);return}if(!this.authorizationStateCallbackInProgress){this.authorizationStateCallbackInProgress=true;this.authorizationStateCallbackTimer=setTimeout("MELI._authFail();",this.options.auth_timeout);if(this.appInfo==null){this._getApplicationInfo(this._authorize)}else{this._authorize()}}},_getApplicationInfo:function(callback){if(!this.initialized){this.initCallbacks.push(this._partial(this._getApplicationInfo,callback));return}var self=this;this.get("/applications/"+this.options.client_id,{},function(response){self.appInfo=response[2];if(callback){callback()}})},_onAuthorizationStateAvailable:function(authorizationState){this.authorizationStateCallbackInProgress=false;this.isAuthorizationStateAvaible=true;this._triggerSessionChange();var localCallbacks=this.authorizationStateAvailableCallbacks.splice(0,this.authorizationStateAvailableCallbacks.length);while(localCallbacks.length>0){var callback=localCallbacks.shift();callback(authorizationState)}},getLoginStatus:function(callback){if(!this.initialized){this.initCallbacks.push(this._partial(this.getLoginStatus,callback));return}if(this.isAuthorizationStateAvaible){var key=this._getKey();if(this.authorizationState[key]!=null&&!this._isExpired(this.authorizationState[key])){callback(this.authorizationState[key])}else{this.isAuthorizationStateAvaible=false;this.authorizationStateAvailableCallbacks.push(callback);this._synchronizeAuthorizationState(true)}}else{this.authorizationStateAvailableCallbacks.push(callback);this._synchronizeAuthorizationState(true)}},_expireToken:function(key){if(!this.initialized){this.initCallbacks.push(this._partial(this._expireToken,key));return}XAuth.expire({key:key});MELI.authorizationState[key]=null;cookie("ats",null,{domain:document.domain,path:"/"});this.secret=null},tokenIssue:function(response){return response[0]!=200&&((response[2].error!=null&&((Object.prototype.toString.call(response[2].error)==="[object Array]"&&response[2].error[0].match(/.*(token|OAuth).*/))||(typeof(response[2].error)==="string"&&response[2].error.match(/.*(token|OAuth).*/))))||(response[2].message!=null&&response[2].message.match(/.*(token|OAuth).*/))||response[0]==403)},_wrap:function(url,method,params,options,callback){var key=this._getKey();var self=this;var wrapper=function(response){var properCallback=self._partial(callback,response);var success=function(){if(method=="get"){Sroc.get(self._url(url),params,self._wrap(url,method,params,{},callback))}else{if(method=="post"){}}};var failure=function(){properCallback()};if(self.tokenIssue(response)){if(!self.authorizationStateCallbackInProgress&&self.isAuthorizationStateAvaible){self.isAuthorizationStateAvaible=false;self._expireToken(key)}if(options.retry){self.withLogin(success,failure,self.showLogin)}else{failure()}}else{properCallback()}};return wrapper},get:function(url,params,callback,next){if(!this.initialized){this.initCallbacks.push(this._partial(this.get,url,params,callback,next));return}if(!next){next=this._wrap(url,"get",params,{retry:true},callback)}Sroc.get(this._url(url),params,next)},post:function(url,params,callback){if(!this.initialized){this.initCallbacks.push(this._partial(this.post,url,params,callback));return}var self=this;var call=function(){Sroc.post(self._url(url),params,self._wrap(url,"post",params,{},callback))};this.withLogin(call,callback,self.showLogin)},remove:function(url,params,callback){if(!this.initialized){this.initCallbacks.push(this._partial(this.remove,url,params,callback));return}if(!params){params={}}Sroc.remove(this._url(url),params,this._wrap(url,"delete",params,{},callback))},getToken:function(){var key=this._getKey();var authorizationState=this.authorizationState[key];if(authorizationState!=null){var token=authorizationState.authorization_info.access_token;var expirationTime=authorizationState.authorization_info.expires_in;if(token&&expirationTime){var dateToExpire=new Date(parseInt(expirationTime));var now=new Date();if(dateToExpire<=now){token=null}}return(token&&token.length>0)?token:null}else{return null}},withLogin:function(successCallback,failureCallback,forceLogin){if(!this.initialized){this.initCallbacks.push(this._partial(this.withLogin,successCallback,failureCallback,forceLogin));return}var self=this;this.getLoginStatus(function(authorizationState){if(authorizationState.state=="AUTHORIZED"){successCallback()}else{if(forceLogin){self.pendingCallbacks.push(successCallback);self.login()}else{if(failureCallback){failureCallback()}}}})},login:function(){if(!this.initialized){this.initCallbacks.push(this.login);return}this._popup(this._authorizationURL(true))},_iframe:function(url,id){if(!id){id="xauthIFrame"}var iframe=document.getElementById(id);if(!iframe||iframe.length==0){var elem=window.document.createElement("iframe");var r=elem.style;r.position="absolute";r.left=r.top="-999px";elem.id=id;window.document.body.appendChild(elem);elem.src=url}else{iframe.src=url}},_authorize:function(){MELI._iframe(MELI._authorizationStateURL())},bind:function(event,callback){if(typeof(this.callbacks[event])=="undefined"){this.callbacks[event]=[]}this.callbacks[event].push(callback)},trigger:function(event,args){var callbacks=this.callbacks[event];if(typeof(callbacks)=="undefined"){return}for(var i=0;i<callbacks.length;i++){callbacks[i].apply(null,args)}},refreshToken:function(){XAuth.expire({key:this._getKey()});this.authorizationState[this._getKey()]=null;this._synchronizeAuthorizationState(true)},logout:function(){this._expireToken(this._getKey());this._iframe(this._logoutURL(),"logoutFrame")},_triggerSessionChange:function(){this.trigger("session.change",[this.getToken()?true:false])},getSession:function(){return this.authorizationState[this._getKey()]},_url:function(url){url=this.baseURL+url;var urlParams="";var token=this.getToken();if(token){var append=url.indexOf("?")>-1?"&":"?";url+=append+"access_token="+token}if(urlParams.length>0){append=url.indexOf("?")>-1?"&":"?";url+=append+urlParams}return url},_parseHash:function(){var localHash=window.location.hash;if(localHash.length==0){return}localHash=localHash.substr(1);if(localHash.length==0){return}var self=this;if(localHash[0]=="%"||localHash[0]=="{"){self.hash=JSON.parse(unescape(localHash))}else{var pairs=localHash.split("&");for(var i=0;i<pairs.length;i++){var pair=null;if(pair=pairs[i].match(/([A-Za-z_\-]+)=(.*)$/)){self.hash[pair[1]]=pair[2]}}}},_notifyParent:function(message){var p=window.opener||window.parent;if(typeof(p)=="undefined"){return}if(!this.messages){if(message.methodName=="meli::loginComplete"){p._loginComplete(message.secret)}else{if(message.methodName=="meli::authComplete"){p._authComplete(message.secret)}else{if(message.methodName=="meli::logout"){p._logoutComplete()}else{if(message.methodName=="meli::close"){p._logoutComplete()}}}}}else{p.postMessage(JSON.stringify({cmd:message.methodName,data:message.secret}),"*")}},_checkPostAuthorization:function(){var p=window.opener||window.parent;var shouldClose=false;if(this.hash.state&&this.hash.state=="iframe"){if(!this.hash.error){this.options={client_id:RegExp("(APP_USR\\-)(\\d+)(\\-)").exec(this.hash.access_token)[2]};var key=this._getKey();var authorizationState={state:"AUTHORIZED",authorization_info:{access_token:this.hash.access_token,expires_in:new Date(new Date().getTime()+parseInt(this.hash.expires_in)*1000).getTime(),user_id:this.hash.user_id}};var secret=this.store.setSecure(key,{key:key,data:authorizationState,expire:authorizationState.authorization_info.expires_in,extend:["*"]})}this._notifyParent({methodName:"meli::loginComplete",secret:secret});shouldClose=true}else{if(this.hash.state){authorizationState=this.hash;var key=this.hash.client_id+this.AUTHORIZATION_STATE;if(!this.hash.authorization_info&&(this.hash.state=="UNKNOWN"||this.hash.state=="NOT_AUTHORIZED")){this.hash.authorization_info={access_token:null,expires_in:new Date(new Date().getTime()+parseInt(10800)*1000).getTime(),user_id:null}}else{if(this.hash.authorization_info){var expiration=new Date().getTime()+(this.hash.authorization_info?this.hash.authorization_info.expires_in*1000:0);this.hash.authorization_info.expires_in=expiration}}var secret=this.store.setSecure(key,{key:key,data:authorizationState,expire:expiration,extend:["*"]});this._notifyParent({methodName:"meli::authComplete",secret:secret});shouldClose=true}else{if(this.hash.action=="logout"){this._notifyParent({methodName:"meli::logout"});shouldClose=true}}}if(shouldClose&&top===self){close()}},_loginComplete:function(secret){if(this._popupWindow){var isModal=false;try{isModal=this._popupWindow.type&&this._popupWindow.type=="modal"}catch(e){}if(isModal){this._popupWindow.hide();this._popupWindow=null}else{this._popupWindow.postMessage(JSON.stringify({cmd:"meli::close",id:"-1"}),"*")}}var self=this;this.authorizationStateAvailableCallbacks.push(function(authState){while(self.pendingCallbacks.length>0){(self.pendingCallbacks.shift())()}});this._storeSecret(secret);this._synchronizeAuthorizationState(false)},_logoutComplete:function(){this._storeSecret(null);document.body.removeChild(document.getElementById("logoutFrame"));this._triggerSessionChange()},_authFail:function(secret){if(this.authorizationStateCallbackTimer){clearTimeout(this.authorizationStateCallbackTimer);this.authorizationStateCallbackTimer=null}MELI._iframe(MELI._xd_url());MELI._authComplete(null)},_authComplete:function(secret){if(this.authorizationStateCallbackTimer){clearTimeout(this.authorizationStateCallbackTimer);this.authorizationStateCallbackTimer=null}var self=this;this._storeSecret(secret);this._synchronizeAuthorizationState(false)},_storeSecret:function(secret){cookie("ats",JSON.stringify(secret),{domain:document.domain,path:"/"});this.secret=secret},_popup:function(url){if(!this._popupWindow||this._popupWindow.closed){var width=830;var height=510;var left=parseInt((screen.availWidth-width)/2);var top=parseInt((screen.availHeight-height)/2);if(this.options.login_function){this._popupWindow=this.options.login_function(url).show()}else{this._popupWindow=(window.open(url,"","toolbar=no,status=no,location=yes,menubar=no,resizable=no,scrollbars=no,width="+width+",height="+height+",left="+left+",top="+top+"screenX="+left+",screenY="+top))}this._popup.on}else{if(this._popupWindow.focus){this._popupWindow.focus()}}},_getKey:function(){var key=null;try{key=this.options.client_id+this.AUTHORIZATION_STATE}catch(Error){key=""}return key},_updateSecret:function(){try{if(cookie("ats")!=null){this.secret=JSON.parse(unescape(cookie("ats")))}}catch(e){this.secret=null}},_authorizationStateURL:function(){return this.authorizationStateURL.replace("SITE",this.appInfo.site_id.toLowerCase())+"?client_id="+this.options.client_id+"&redirect_uri="+encodeURIComponent(this._xd_url())+"&response_type=token"},_authorizationURL:function(interactive){return this.authorizationURL+"?redirect_uri="+encodeURIComponent(this._xd_url())+"&response_type=token&client_id="+this.options.client_id+"&state=iframe&display=popup&interactive="+(interactive?1:0)},_logoutURL:function(){return this.logoutURL+encodeURIComponent(this._xd_url()+"#action=logout")},_xd_url:function(){return"http://"+this.options.xauth_domain+(this.options.xauth_port?":"+this.options.xauth_port:"")+this.options.xd_url}};MELI._parseHash();MELI._checkPostAuthorization();window.MELI=MELI;if(typeof(window.mlAsyncInit)=="function"){window.mlAsyncInit()}})(cookie,XAuth)})();